{"chunk":12,"numChunks":15,"fileHash":"dLUtq845VDWGGrS77+61hd7n4EwdJnc0aPkug0yaZTE=","filePath":"internal/queries/products.go","content":"package queries\nfunc (q *ProductQueries) ProductDigital(ctx context.Context, productID string) (*models.Digital, error) {\n\tdigital := &models.Digital{}\n\n\tquery := `\n\t\t\tSELECT \n\t\t\t\t\tp.digital,\n\t\t\t\t\tdf.id, df.name, df.ext,\n\t\t\t\t\tdd.id, dd.content, dd.cart_id\n\t\t\tFROM product p\n\t\t\tLEFT JOIN digital_file df ON p.id = df.product_id\n\t\t\tLEFT JOIN digital_data dd ON p.id = dd.product_id\n\t\t\tWHERE p.id = ?\n\t`\n\n\trows, err := q.DB.QueryContext(ctx, query, productID)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\tdefer rows.Close()\n\n\tvar digitalType sql.NullString\n\tfor rows.Next() {\n\t\tvar fileID, fileName, fileExt sql.NullString\n\t\tvar dataID, dataContent, cartID sql.NullString\n\n\t\terr := rows.Scan(\n\t\t\t&digitalType,\n\t\t\t&fileID, &fileName, &fileExt,\n\t\t\t&dataID, &dataContent, &cartID,\n\t\t)\n\t\tif err != nil {\n\t\t\treturn nil, err\n\t\t}\n\n\t\tif digital.Type == \"\" {\n\t\t\tdigital.Type = digitalType.String\n\t\t}\n\n\t\tif fileID.Valid {\n\t\t\tfile := models.File{\n\t\t\t\tID:   fileID.String,\n\t\t\t\tName: fileName.String,\n\t\t\t\tExt:  fileExt.String,\n\t\t\t}\n\t\t\tdigital.Files = appen d(digital.Files, file)\n\t\t}\n\t\tif dataID.Valid {\n\t\t\tdata := models.Data{\n\t\t\t\tID:      dataID.String,\n\t\t\t\tContent: dataContent.String,\n\t\t\t\tCartID:  cartID.String,\n\t\t\t}\n\t\t\tdigital.Data = append(digital.Data, data)\n\t\t}\n\t}\n\n\tif err := rows.Err(); err != nil {\n\t\treturn nil, err\n\t}\n\n\treturn digital, nil\n}\n// AddDigitalFile associates a digital file with"}