{"chunk":6,"numChunks":15,"fileHash":"dLUtq845VDWGGrS77+61hd7n4EwdJnc0aPkug0yaZTE=","filePath":"internal/queries/products.go","content":"package queries\nfunc (q *ProductQueries) Product(ctx context.Context, private bool, id string) (*models.Product, error) {\n\tproduct := &models.Product{}\n\n\tquery := `\n\t\t\tSELECT DISTINCT\n\t\t\t\tproduct.id,\n\t\t\t\tproduct.name, \n\t\t\t\tproduct.brief,\n\t\t\t\tproduct.desc, \n\t\t\t\tproduct.slug, \n\t\t\t\tproduct.amount,\n\t\t\t\tproduct.active,\n\t\t\t\tproduct.metadata, \n\t\t\t\tproduct.attribute, \n\t\t\t\tproduct.digital,\n\t\t\t\tproduct.seo, \n\t\t\t\tjson_group_array(json_object('id', pi.id, 'name', pi.name, 'ext', pi.ext)) as images,\n\t\t\t\tstrftime('%s', product.created), \n\t\t\t\tstrftime('%s', product.updated)\n\t\t\tFROM product \n\t\t\tLEFT JOIN product_image pi ON product.id = pi.product_id\n\t`\n\tif private {\n\t\tquery += ` WHERE product.id = ?`\n\t} else {\n\t\tquery += ` LEFT JOIN digital_data ON digital_data.product_id = product.id   \n\t\t\t\t\t\t\t\t\t\t LEFT JOIN digital_file ON digital_file.product_id = product.id \n\t\t\t\t\t\t\t\t\t\t WHERE product.slug = ? AND product.active = 1`\n\t}\n\n\tvar images, metadata, attributes, digitalType, seo sql.NullString\n\tvar updated sql.NullInt64\n\n\terr := q.DB.QueryRowContext(ctx, query, id)."}