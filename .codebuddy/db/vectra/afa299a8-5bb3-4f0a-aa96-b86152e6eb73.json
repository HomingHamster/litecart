{"chunk":1,"numChunks":2,"fileHash":"DAZbGuj7ZhPHeAjanVKK0/jyXqfZcyoiWZ4tRBiUSqs=","filePath":"web/admin/src/components/page/Update.vue","content":"import { computed } from \"vue\";\nimport { FormInput, FormButton, FormSelect } from \"@/components/\";\nimport { showMessage } from \"@/utils/message\";\nimport { apiUpdate, apiDelete } from \"@/utils/api\";\nimport { Form } from \"vee-validate\";\n\nconst positionPage = [\"header\", \"footer\"];\nconst props = defineProps({\n  page: {\n    required: true,\n  },\n  pages: {\n    required: true,\n  },\n  updateActive: Function,\n  close: Function,\n});\n\nconst emits = defineEmits([\"update:modelValue\"]);\nconst page = computed({\n  get: () => {\n    return props.page;\n  },\n  set: (val) => {\n    emits(\"update:modelValue\", val);\n  },\n});\n\nconst pages = computed({\n  get: () => {\n    return props.pages;\n  },\n  set: (val) => {\n    emits(\"update:modelValue\", val);\n  },\n});\n\nconst updatePage = async () => {\n  const update = { ...page.value };\n  apiUpdate(`/api/_/pages/${update.id}`, update).then(res => {\n    if (res.success) {\n      const found = pages.value.find((e) => e.id === update.id);\n      found.name = update.name;\n      found.slug = update.slug;\n      found.position = update.position;\n      showMessage(res.message);\n    } else {\n      showMessage(res.result, \"connextError\");\n    }\n  });\n};\n\nconst deletePage = async () => {\n  const index = page.value.index;\n  apiDelete(`/api/_/pages/${pages.value[index].id}`).then(res => {\n    if (res.success) {\n      pages.value.splice(index, 1);\n    } else {\n      const obj = JSON.parse(res.result);\n      if (obj.code === \"resource_missing\") {\n        console.log(obj.message);\n      }\n    }\n    props.close();\n  });\n};\n</script>\n"}