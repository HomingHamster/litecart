{"chunk":0,"numChunks":1,"fileHash":"wBe8cNPY6RtRKZmuEss9ekCH7nvY4wNSZqaFTrkS9sA=","filePath":"pkg/jwtutil/generator.go","content":"package jwtutil\n\nimport (\n\t\"github.com/golang-jwt/jwt/v5\"\n)\n\ntype Setting struct {\n\tSecret            string\n\tSecretExpireHours int\n}\n\n// GenerateNewToken func for generate a new Access token.\nfunc GenerateNewToken(secret, id string, expires int64, credentials []string) (string, error) {\n\tclaims := jwt.MapClaims{}\n\tclaims[\"id\"] = id\n\tclaims[\"expires\"] = expires\n\n\tfor _, credential := range credentials {\n\t\tclaims[credential] = true\n\t}\n\n\ttoken := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\taccessToken, err := token.SignedString([]byte(secret))\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\treturn accessToken, nil\n}\n"}